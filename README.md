# VR 사격장 구현
VR 환경에서 사격 연습장을 구현한다. 구현되는 기능 목록
1. 플레이어 및 플레이어의 이동
2. 총과 관련한 기능
3. UI
4. 사운드
5. 라이트
## VR 환경 구현
1. `Unity` `3D URP` 프로젝트 탬플릿으로 생성
2. `XR Interaction Toolkit`으로 개발한다. 관련한 패키지들을 추가적으로 받는다
3. 빌드셋팅 및 프로젝트 세팅을 한다. 수업영상을 참고한다.

---
## 1. 플레이어
플레이어와 관련한 기능. 대부분은 `XR Interaction Setup`의 기본 기능들을 사용한다. 해당하는 오브젝트는 Sample에 있다.
### 표현
손 모델링으로만 구현한다.

### 이동
좌측 컨트롤러로 구현.

### 시선
`HMD`의 회전에 의해 시야가 회전한다. 즉, 사용자가 고개를 돌리는 만큼 회전한다. 이는 기본적으로 제공되는 기능을 사용한다.

### 그랩
`Controller`를 사용한다. 트리거 버튼을 사용해서 그랩한다. `Force Grab`으로 플레이어의 위치로 물체를 당겨온다. 총의 경우, 처음 그립을 잡는 손을 방아쇠 쪽으로 이동시킨다
-> 주 손(왼쪽, 오른쪽 둘 다 해당)을 방아쇠가 있는 총 손잡이 쪽을 잡는다. 권총의 경우에는 한 손으로 사격한다
-> 보조 손을 총열 밑에 파지하는 것으로 한다.

---
## 2. 총
총은 3가지를 구현한다. 권총, 소총, 저격총
1. 권총 : 한 손으로 사격하는 총
2. 소총 : 두 손으로 사격하는 총. 연사모드가 있다.
3. 저격 총 : 두 손으로 사격하는 총. 스코프가 있다.

### 구성
1. 총 몸체
2. 탄창
3. 탄알
4. 발사된 탄알
5. 재질에 따른 피격 이펙트
6. 발사 이펙트 및 라이트
### 조준
손으로 그랩한 총을 본인이 원하는 위치에 가져간다. 스코프 기능을 추가적으로 구현할 것이다. 발사버튼을 누르면 총알이 발사된다.

### 발사
발사 버튼을 누를 시, 총에서 총알이 발사된다. 발사된 총알은 미리 계산된 궤적을 따라 날아가고, `Rigidbody`, `Collider`를 가진다. `Object Pool`로 구현된다. 타겟 또는 다른 물체들에 맞을 시 해당하는 이펙트 생성(나무면 나무, 콘크리트면 콘크리트, 철이면 철 Impact)과 동시에 총알은 `Pool`에 반납된다. 만약 타겟과 충돌 시 해당 함수를 수행하고 사라진다. 총알이 발사 되는 방향은 

### 스코프
스코프 기능은 `Render Texture`, `Shader Graph` 등을 이용한다. 스코프 중앙에는 실제 총 처럼 기준 포인트를 표시하고, 총열 부분의 조준점과 일치시켜서 발사한다.

---
## 3. UI
1. 총에 컨트롤러 포인터를 가져가 하이라이트 시, 표시될 총의 정보 UI
2. 타겟을 쓰러뜨릴 때 나오는 점수 UI
  - 나올 때 흰색에서 지정된 색깔로 점점 변한다(0.1초안에 이루어짐)
  - 점수는 100단위로 한다. 작은숫자부터 큰 숫자단위로 한 글자씩 출력한다. 숫자 간 출력 간격은 0.1초.
  - 한 숫자씩 큰 크기에서 지정된 크기로 점점 줄어든다(동일하게 0.1초)
  - UI 표기와 동시에 총 점수에 더한다
  - 총 점수 UI를 최신화한다.
  - 표기 후 점수가 느린 속도로 위로 올라가면서 페이드아웃된다
3. 총 점수 (Total Score)
  - 게임 중에 표시하는 총 점수, 게임이 끝난 후 표시하는 총 점수를 나눈다.  
  - 이름 및 점수를 보여주는 리더보드는 칠판 게임 오브젝트로 표기
  - 이번에는 1등~10등 점수를 따로 미리 지정하지 않고, 점점 늘려가서 표기하는 식으로 변경한다
  - 리스트<구조체>로 점수 및 이름을 관리. 구조체로 IComparer를 상속받아 비교할 수 있게 한다.
  - 신규 점수가 등록 될 시 정렬(Sort)을 사용한다
  - 게임 완료 후 총 점수가 10등을 초과하는 점수 달성 시, 10등을 삭제하고 새로운 10등으로 추가한다. 추가한 후 정렬을 사용한다.
4. 게임 시작 버튼 구현
  - 게임 시작은 사격 사로에서 누르는 걸로 구현.
  - 버튼을 누르면 타이머가 돌아가면서 게임이 시작
5. 과적 UI
  - 남은 과적 / 전체 과적
6. 탄창 UI
  - 남은 탄알 / 전체 탄알
7. 타이머 UI
  - 남은시간
  - 10초 이하면 빨간색으로 점멸
  - 0초가 되면 종료 소리와 함께 게임 완료
8. 게임 결과 창 UI
  - 처치한 과적
  - 총 점수
  - 점수 갱신 시 입력
## 4. 사운드
사운드 매니저로 관리
총알 사운드는 
1. 걷는소리
2. 게임시작소리
3. 재장전 소리
4. 재질에 따른 피격 소리
5. 게임 완료 소리
6. 방아쇠 당기는 소리(총알이 없을 시 재생)
7. 발사 소리
## 5. 라이트
라이트는 맵 전체를 꾸민 후, 라이트맵을 생성(Bake)한다
1. 총 발사 시 포인트 라이트
2. 총알이 철 재질 피격 시 포인트 라이트